<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- <link rel="shortcut icon" type="image/icon" href="../../public/images/logo.png" />
    <link rel ="stylesheet" href ="../../public/stylesheets/custom.css">
    <link rel ="stylesheet" href ="../../public/stylesheets/carousel.css">
    <link rel ="stylesheet" href ="../../public/stylesheets/bootstrap.min.css">
    <script src ="../../public/javascripts/bootstrap.min.js" type ="text/javascript"></script>
    <script src ="../../public/javascripts/jquery.js" type ="text/javascript"></script> -->
    <title>Swastik|Stats</title>
</head>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    chartIt();

    async function chartIt() {
        var chartData = await getData();
        google.charts.load('current', {
            'packages': ['corechart']
        });
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            console.log(chartData);
            var dat = [
                ["Disease", "Count"]
            ];;
            chartData.forEach(element => {
                dat.push(element);
            });
            var data = google.visualization.arrayToDataTable(dat);

            var options = {
                title: 'Diseases'
            };

            var chart = new google.visualization.PieChart(document.getElementById('piechart'));

            chart.draw(data, options);

        }
    }

    async function getData() {
        const response = await fetch('http://localhost:3000/statistics/patients_count_wrt_disease');
        console.log(response);
        const data = await response.json();
        const parsedData = Object.entries(data);
        console.log(parsedData);
        return parsedData;
    }
</script>
<script type="text/javascript">
    chartIt();
    async function chartIt() {
        var chartData = await getData();
        google.charts.load('current', {
            'packages': ['bar']
        });
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var dat = [
                ['Pincode', 'Children Affected']
            ];;
            chartData.forEach(element => {
                dat.push(element);
            });
            var data = google.visualization.arrayToDataTable(dat);

            var options = {
                chart: {
                    title: 'Children Affected',
                    subtitle: 'In an area',
                }
            };

            var chart = new google.charts.Bar(document.getElementById('columnchart_material'));

            chart.draw(data, google.charts.Bar.convertOptions(options));
        }
    }
    async function getData() {
        const response = await fetch('http://localhost:3000/statistics/children/pincode');
        console.log(response);
        const data = await response.json();
        const parsedData = Object.entries(data);
        console.log(parsedData);
        return parsedData;
    }
</script>


<body>
    <div id="piechart" style="width: 900px; height: 500px;"></div>
    <div id="columnchart_material" style="width: 800px; height: 500px;"></div>


</body>

</html>